# üîê Gitleaks Pre-Commit Hook

–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å–µ–∫—Ä–µ—Ç—ñ–≤ –ø–µ—Ä–µ–¥ –∫–æ–∂–Ω–∏–º `git commit` –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é [gitleaks](https://github.com/gitleaks/gitleaks).

---

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

### üç¥ –ö—Ä–æ–∫ 1 ‚Äî –§–æ—Ä–∫–Ω—ñ—Ç—å —Ä–µ–ø–æ

–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É **Fork** —É –ø—Ä–∞–≤–æ–º—É –≤–µ—Ä—Ö–Ω—å–æ–º—É –∫—É—Ç—ñ –Ω–∞ GitHub.

> –¶–µ —Å—Ç–≤–æ—Ä–∏—Ç—å –≤–∞—à—É –æ—Å–æ–±–∏—Å—Ç—É –∫–æ–ø—ñ—é —Ä–µ–ø–æ ‚Äî –≤–∏ –∑–º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –π–æ–≥–æ –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –æ—Ä–∏–≥—ñ–Ω–∞–ª—É.

### üì• –ö—Ä–æ–∫ 2 ‚Äî –ö–ª–æ–Ω—É–π—Ç–µ —Å–≤—ñ–π —Ñ–æ—Ä–∫

```bash
git clone git@github.com:YOUR_USERNAME/gitleaks-pre-commit-hook.git
cd gitleaks-pre-commit-hook
```

### ‚ö°Ô∏è –ö—Ä–æ–∫ 3 ‚Äî –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –æ–¥–Ω–∏–º —Ä—è–¥–∫–æ–º

```bash
curl -sSL https://raw.githubusercontent.com/YOUR_USERNAME/gitleaks-pre-commit-hook/main/install.sh | sh
```

> –ó–∞–º—ñ–Ω—ñ—Ç—å  –Ω–∞ –≤–∞—à GitHub username.
> –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç—å  —Ç–∞ –Ω–∞–ª–∞—à—Ç—É—î hook.

### üîß –ê–±–æ –≤—Ä—É—á–Ω—É (–±–µ–∑ curl)

```bash
# 1. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ gitleaks
brew install gitleaks          # macOS
# –∞–±–æ https://github.com/gitleaks/gitleaks/releases  # Linux

# 2. –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ hook
cp pre-commit .git/hooks/pre-commit
chmod +x .git/hooks/pre-commit
```

### –ß–æ–º—É Fork –∞ –Ω–µ –ø—Ä—è–º–∏–π curl?

| | Fork | –ü—Ä—è–º–∏–π curl |
|---|---|---|
| –í–∞—à–∞ –∫–æ–ø—ñ—è —Ä–µ–ø–æ | ‚úÖ | ‚ùå |
| –ú–æ–∂–Ω–∞ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ | ‚úÖ | ‚ùå |
| –ù–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ –æ—Ä–∏–≥—ñ–Ω–∞–ª—É | ‚úÖ | ‚ùå |
| –ú–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è | ‚úÖ | ‚ùå |

---

## –Ø–∫ –ø—Ä–∞—Ü—é—î hook

–ü—Ä–∏ –∫–æ–∂–Ω–æ–º—É `git commit` hook –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:

1. –ü–æ–∫–∞–∑—É—î –ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞—Ç—É—Å (—É–≤—ñ–º–∫–Ω–µ–Ω–æ/–≤–∏–º–∫–Ω–µ–Ω–æ)
2. –°–∫–∞–Ω—É—î –ª–∏—à–µ **staged —Ñ–∞–π–ª–∏** (—Ç–µ —â–æ –π–¥–µ —É –∫–æ–º—ñ—Ç)
3. –ë–ª–æ–∫—É—î –∫–æ–º—ñ—Ç —è–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ —Å–µ–∫—Ä–µ—Ç–∏
4. –í–∏–≤–æ–¥–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–∏–π –∑–≤—ñ—Ç —ñ–∑ –∑–∞–º–∞—Å–∫–æ–≤–∞–Ω–∏–º–∏ —Å–µ–∫—Ä–µ—Ç–∞–º–∏

---

## –ö–µ—Ä—É–≤–∞–Ω–Ω—è hook'–æ–º

```bash
# –í–∏–º–∫–Ω—É—Ç–∏ —Ç–∏–º—á–∞—Å–æ–≤–æ
git config hooks.gitleaks.enable false

# –£–≤—ñ–º–∫–Ω—É—Ç–∏ –∑–Ω–æ–≤—É
git config hooks.gitleaks.enable true

# –ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ
SKIP_GITLEAKS=1 git commit -m "..."
```

---

## –í–∏–∫–ª—é—á–µ–Ω–Ω—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä—è–¥–∫–∞

```python
MY_VAR = "not-a-real-secret"  # gitleaks:allow
```

---

## –©–æ —Ä–æ–±–∏—Ç–∏ —è–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ —Å–µ–∫—Ä–µ—Ç

1. **–í–∏–¥–∞–ª—ñ—Ç—å** —Å–µ–∫—Ä–µ—Ç –∑ –∫–æ–¥—É
2. **–ó–∞–º—ñ–Ω—ñ—Ç—å** –Ω–∞ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞:
```python
# ‚ùå –ü–æ–≥–∞–Ω–æ
TOKEN = "7341852096:AAF3zKpL8mNqR2tVxW0yZ1dCeJ4gHiUoPs6"  # gitleaks:allow

# ‚úÖ –î–æ–±—Ä–µ
TOKEN = os.environ.get("TELEGRAM_BOT_TOKEN")
```
3. –î–æ–¥–∞–π—Ç–µ `.env` –¥–æ `.gitignore`
4. –Ø–∫—â–æ —Å–µ–∫—Ä–µ—Ç **–≤–∂–µ –ø–æ—Ç—Ä–∞–ø–∏–≤ –≤ —ñ—Å—Ç–æ—Ä—ñ—é** ‚Äî –≤—ñ–¥–∫–ª–∏—á—Ç–µ –π–æ–≥–æ –Ω–µ–≥–∞–π–Ω–æ!

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è ‚Äî –¥–≤–∞ Use Cases

### Use Case 1 ‚Äî –¢–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª –∑ —Å–µ–∫—Ä–µ—Ç–∞–º–∏

–°–∫–æ–ø—ñ—é–π—Ç–µ –≤–º—ñ—Å—Ç –Ω–∏–∂—á–µ —É –Ω–æ–≤–∏–π —Ñ–∞–π–ª `my_config_test.py`:

> ‚ö†Ô∏è  –ö–æ–ø—ñ—é–π—Ç–µ **–±–µ–∑** –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ `# gitleaks:allow` ‚Äî –≤–æ–Ω–∏ –¥–æ–¥–∞–Ω—ñ –ª–∏—à–µ —â–æ–± README –º–æ–∂–Ω–∞ –±—É–ª–æ –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏. –ë–µ–∑ –Ω–∏—Ö hook —Å–ø—Ä–∞—Ü—é—î —è–∫ —Ç—Ä–µ–±–∞.

```python
# my_config_test.py ‚Äî —Ç–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ gitleaks hook

import os

# ‚îÄ‚îÄ 1. Telegram Bot Token ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# ‚ùå –ù–ï–ë–ï–ó–ü–ï–ß–ù–û: —Ç–æ–∫–µ–Ω –∑–∞—Ö–∞—Ä–¥–∫–æ–¥–∂–µ–Ω–∏–π —É –∫–æ–¥—ñ
TELEGRAM_BOT_TOKEN = "7341852096:AAF3zKpL8mNqR2tVxW0yZ1dCeJ4gHiUoPs6"  # gitleaks:allow

# ‚úÖ –ë–ï–ó–ü–ï–ß–ù–û: —Ç–æ–∫–µ–Ω –±–µ—Ä–µ—Ç—å—Å—è –∑—ñ –∑–º—ñ–Ω–Ω–æ—ó —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
# TELEGRAM_BOT_TOKEN = os.environ.get("TELEGRAM_BOT_TOKEN")


# ‚îÄ‚îÄ 2. AWS Access Key ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# ‚ùå –ù–ï–ë–ï–ó–ü–ï–ß–ù–û
AWS_ACCESS_KEY_ID     = "AKIAIOSFODNN7EXAMPLE"
AWS_SECRET_ACCESS_KEY = "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"

# ‚úÖ –ë–ï–ó–ü–ï–ß–ù–û
# AWS_ACCESS_KEY_ID     = os.environ.get("AWS_ACCESS_KEY_ID")
# AWS_SECRET_ACCESS_KEY = os.environ.get("AWS_SECRET_ACCESS_KEY")


# ‚îÄ‚îÄ 3. Generic API Key ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# ‚ùå –ù–ï–ë–ï–ó–ü–ï–ß–ù–û
API_KEY = "sk-proj-abc123def456ghi789jkl012mno345pqr678stu901vwx"  # gitleaks:allow

# ‚úÖ –ë–ï–ó–ü–ï–ß–ù–û
# API_KEY = os.environ.get("API_KEY")


# ‚îÄ‚îÄ –ë–µ–∑–ø–µ—á–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ –∫–æ–¥—É ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
DATABASE_URL = os.environ.get("DATABASE_URL", "postgresql://localhost:5432/mydb")
DEBUG = os.environ.get("DEBUG", "false").lower() == "true"
```

–ü–æ—Ç—ñ–º —Å–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏:

```bash
git add my_config_test.py
git commit -m "test: check sensitive values"
```

Hook –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å —Ñ–∞–π–ª —ñ –ø–æ–∫–∞–∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚ùå **–ó–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ** ‚Äî –∑–Ω–∞–π–¥–µ–Ω–æ —Å–µ–∫—Ä–µ—Ç–∏ (Telegram token, AWS key, API key)
- ‚úÖ **–ü—Ä–æ–π—à–ª–æ** ‚Äî —Å–µ–∫—Ä–µ—Ç—ñ–≤ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ

```bash
# –ü—ñ—Å–ª—è —Ç–µ—Å—Ç—É ‚Äî –ø—Ä–∏–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª
rm my_config_test.py
```

> –¢–µ —Å–∞–º–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑ **–±—É–¥—å-—è–∫–∏–º –≤–∞—à–∏–º —Ñ–∞–π–ª–æ–º** –¥–µ —î –ø—ñ–¥–æ–∑—Ä–∏ –Ω–∞ —Å–µ–∫—Ä–µ—Ç–∏ ‚Äî –ø—Ä–æ—Å—Ç–æ `git add <your_file>` —ñ —Å–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏.

---

### Use Case 2 ‚Äî –í–∏–¥–∞–ª–∏—Ç–∏ `# gitleaks:allow` –∑ `test_hook.py`

–£ —Ñ–∞–π–ª—ñ `test_hook.py` —î —Ä—è–¥–æ–∫ **62** –¥–µ —Ç–æ–∫–µ–Ω –¥–æ–∑–≤–æ–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ –∫–æ–º–µ–Ω—Ç–∞—Ä:

```python
# –†—è–¥–æ–∫ 62 —É test_hook.py:
FAKE_SECRET = "7341852096:AAF3zKpL8mNqR2tVxW0yZ1dCeJ4gHiUoPs6"  # gitleaks:allow
```

–í–∏–¥–∞–ª—ñ—Ç—å `# gitleaks:allow` ‚Äî —Å—Ç–∞–Ω–µ —Ç–∞–∫:

```python
FAKE_SECRET = "7341852096:AAF3zKpL8mNqR2tVxW0yZ1dCeJ4gHiUoPs6"  # gitleaks:allow
```

–ü–æ—Ç—ñ–º:
```bash
git add test_hook.py
git commit -m "test: remove gitleaks allow"
# ‚ùå Hook –∑–∞–±–ª–æ–∫—É—î –∫–æ–º—ñ—Ç
```

–ü—ñ—Å–ª—è —Ç–µ—Å—Ç—É –ø–æ–≤–µ—Ä–Ω—ñ—Ç—å `# gitleaks:allow` –Ω–∞–∑–∞–¥ —ñ –∑–∞–∫–æ–º—ñ—Ç—å—Ç–µ –∑–Ω–æ–≤—É.

---

### –í–∏—Å–Ω–æ–≤–æ–∫

–ó–∞–≥–∞–ª—å–Ω–∏–π —Ñ–ª–æ—É –ø—Ä–æ—Å—Ç–∏–π:

```
git add <—Ñ–∞–π–ª –∑ –ø—ñ–¥–æ–∑—Ä–æ—é –Ω–∞ —Å–µ–∫—Ä–µ—Ç–∏>
git commit -m "test: check sensitive values"
        ‚Üì
‚ùå –ó–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ ‚Üí –∑–Ω–∞–π–¥–µ–Ω–æ —Å–µ–∫—Ä–µ—Ç–∏ ‚Üí –≤–∏–ø—Ä–∞–≤—Ç–µ —ñ –ø–æ–≤—Ç–æ—Ä—ñ—Ç—å
‚úÖ –ü—Ä–æ–π—à–ª–æ    ‚Üí —Å–µ–∫—Ä–µ—Ç—ñ–≤ –Ω–µ–º–∞—î  ‚Üí –≤—Å–µ –≥–∞—Ä–∞–∑–¥
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é

```
‚îú‚îÄ‚îÄ install.sh              ‚Üê —ñ–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä (curl pipe sh)
‚îú‚îÄ‚îÄ pre-commit              ‚Üê hook —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ test_hook.py            ‚Üê —Ç–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ secrets_test_sample.py  ‚Üê —Ç–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª –∑ —Å–µ–∫—Ä–µ—Ç–∞–º–∏ (—É .gitignore)
‚îî‚îÄ‚îÄ README.md               ‚Üê —Ü—è —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è
```

---

## –¢–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç

```bash
python3 test_hook.py
```
